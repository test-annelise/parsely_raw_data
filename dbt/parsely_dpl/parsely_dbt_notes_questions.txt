-- base
events table: actions: pageview, heartbeat (engaged_time_inc), videostart, vheartbeat(engaged_time_inc)

-- pageviews
pageview: 1 row per pageview, summed engaged_time

-- videoviews
videostart: 1 row per videostart, summed engaged_time

-- sessions
roll up: 1 row per sesssion: sum of pageviews, sum of videostarts, sum of engaged_times
returning user, new user

-- user_email and visitor_site_id: identity stitching

-- content
most recent metatdata

-- user
first seen
last

-- DBT questions
- how to best handle incremental loads and updates to events since hbs and vhbs don't come in together
- how to make variables with 's in them

-- DPL questions
- what if metadata_post_id is null?
- incremental edge cases with 0 and null denominators:
  1. PV/VSs with no HBs yeet
  2. HB/VBHs with no PV/VSs yet
- for the read/watch time - should this join to the most recent metadata published time or one that was true at the time? what if it's null at the time of the event?


--assumptions/decisions
- metadata_post_id is not the post_id; canonical_url is closer but not always populated if the url is not in crawl; therefore url is the accurate post_id
